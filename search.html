<!DOCTYPE html>
<html>
<head>

	<!-- TODO
	> save/fetch apriori filters for each dataset
	> upload JSON or Text to the user
	> clean code
	-->

	<!-- Global site tag (gtag.js) - Google Analytics -->
	<!-- <script async src="https://www.googletagmanager.com/gtag/js?id=UA-130197414-1"></script>
	<script>
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'UA-130197414-1');
	</script> -->

	<meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <!-- Bootstrap CSS -->
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
	<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css"/>

    <link rel="stylesheet" href="css/styles.css" type="text/css" />

	<script src="scripts/jquery-3.4.1.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

	<script type="text/javascript" src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
	<!-- <script type="text/javascript" src="https://cdn.datatables.net/1.10.20/js/dataTables.bootstrap.min.js"></script> -->

	<script src="scripts/scripts.js"></script>

    <link rel="icon" type="image/png" href="images/basketwhite.svg"/>

    <title>Association rules mining</title>

	<script>

		$(function() {

      		var resultsTable

			// initialization of tooltips in page
			$('[data-toggle="tooltip"]').tooltip()

			if (!sessionStorage.getItem('token') || sessionStorage.getItem('token')==0) {
				MyModal("Association rules",'Please Sign in, or Sign up if you are a new user, in order to use our new association rules mining engine!');
				setTimeout(function() {
								sessionStorage.clear();
								window.location.href='index.html';
							}, 4000);	
			}

			if (sessionStorage.getItem('version')) {
				$('#navbar-brand').html('<img class="d-inline-block mr-1" src="./images/basketwhite.svg" width="24" height="24" alt="">Association rules ' +  sessionStorage.getItem('version'));
			}
			else {
				sessionStorage.clear();
				window.location.href='index.html';
			}
			M_F();
			VT();

			GetDatasetFilelist();	

			$('#SignOut').click(function() {
				sessionStorage.clear();
				window.location.href='index.html';
			});		

			// Set up an event listener for the contact form.
			$('#uploadDatasetform').submit(function(e) {
				// Stop the browser from submitting the form.
				e.preventDefault();

				//Prepare the data to send
				var formData = new FormData();
				var fileSelect = document.getElementById("fileToUpload");
				if(fileSelect.files && fileSelect.files.length == 1){
                    var file = fileSelect.files[0]
                    formData.set("fileToUpload", file , file.name);
				}
				else {
					MyModal("Information", "You have not chosen a file for upload.<br>Please choose one.");
					return;
				}
				var datasetType = document.getElementById("datasetType");
				if(!datasetType.value){
					MyModal("Information", "You have not chosen datasetType!!!");
					return;
				}
				formData.set("datasetType", datasetType.value);
				if (sessionStorage.getItem('token')) {
					formData.set("token",sessionStorage.getItem('token'));
				}
				else {
					MyModal("Error", "You are not signed in!!! Please sign in/up");
					return;
				}

				// Submit the form using AJAX.
				$.ajax({
					type: 'POST',
					url: $('#uploadDatasetform').attr('action'),
					contentType: false,
                    cache: false,
                    processData:false,
					data: formData
				}).done(function(response) {
					if (isJSON(response)) {
						res=JSON.parse(response);
						if (res.http_response_code==200) {
							MyModal(res.title,res.message);
							GetDatasetFilelist();
						} else {
							MyModal(res.title, res.message);
						}
					}
					else alert(response);
				}).fail(function( jqXHR, textStatus, thrownError ) {
					if (isJSON(jqXHR.responseText)) {
						res=JSON.parse(jqXHR.responseText);
						MyModal(res.title, res.message);
						if (res.http_response_code>=400 && sessionStorage.getItem('token')) {
							setTimeout(function() {
								sessionStorage.clear();
								window.location.href='index.html';
							}, 3000);	
						}
					} 
					else MyModal("Error", jqXHR.responseText);
				});
			});

			// Set up an event listener for the contact form.
			$('#retrieveRules').submit(function(e) {
				// Stop the browser from submitting the form.
				e.preventDefault();

				//Prepare the data to send
				var datasetType = document.getElementById("dataset");
				if(!datasetType.value){
					MyModal("Information", "Please choose a dataset!!!");
					return;
				}

                // Serialize the form data first in array form so to add more elements.
				var formData = $('#retrieveRules').serializeArray(); // convert form to array

				if (sessionStorage.getItem('token')) {
					formData.push({name: "token", value: sessionStorage.getItem('token')});
				}
				else {
					MyModal("Error", "You are not signed in!!! Please sign in/up");
					return;
				}

				// Submit the form using AJAX.
				$.ajax({
					type: 'POST',
					url: $('#retrieveRules').attr('action'),
					data: $.param(formData), //serialize the array
					beforeSend: function( xhr ) {
						$('#submitBtn').html("<b>Retrieving rules...</b>");	
  					}
				})
				.done(function(response) {
					if (isJSON(response)) {
						res=JSON.parse(response);
						if (res.http_response_code!=200) {
							MyModal(res.title, res.message);
						} else {					
						
						try {
							resm=JSON.parse(res.message);
						}
						catch(err){
							MyModal("Error", res.message);
							return;
						}

						if (resultsTable) {
							resultsTable.clear().rows.add(resm.rules).draw();
						} else {
							resultsTable = $('#showResultsTbl').DataTable( {
								stateSave: true,
								data: resm.rules,
								columns: [
									{ "title" : "#",
										"data"  : function ( row, type, val, meta ) {
										return meta.row+1;
										}},
									{ "title" : "LHS-Body",
										"data"  : "LHS",
										"render": "[, ]" },
									{ "title" : "Count/Sup",
										"data"  : function ( row, type, val, meta ) {
											if (type === 'display') {
												return row.LHS_Count + ' / ' + row.LHS_Support.toFixed(3);
											}
											else {
												return row.LHS_Count
											};
										} },
									{ "title" : "RHS-Head",
										"data"  : "RHS",
										"render": "[, ]" },
									{ "title" : "Count/Sup",
										"data"  : function ( row, type, val, meta ) {
											if (type === 'display') {
												return row.RHS_Count + ' / ' + row.RHS_Support.toFixed(3);
											}
											else {
												return row.RHS_Count
											};
										} },
									{ "title" : "Support",
										"data"  : "Support",
										"render": function ( data, type, row, meta ) {
											if (type === 'display') {
												return data.toFixed(3);
											} else {
												return data
											}
										} },										 
									{ "title" : "Confidence",
										"data"  : "Confidence",
										"render": function ( data, type, row, meta ) {
										if (type === 'display') {
												return data.toFixed(3);
											} else {
												return data
											}
										} },
									{ "title" : "Lift",
										"data"  : "Lift",
										"render": function ( data, type, row, meta ) {
										if (type === 'display') {
												return data.toFixed(3);
											} else {
												return data
											}
										} },										
									{ "title" : "Conviction",
										"data"  : "Conviction",
										"render": function ( data, type, row, meta ) {
										if (type === 'display') {
												return data.toFixed(3);
											} else {
												return data
											}
										} },
									{ "title" : "Leverage",
										"data"  : "Leverage",
										"render": function ( data, type, row, meta ) {
										if (type === 'display') {
												return data.toFixed(3);
											} else {
												return data
											}
										} },
								]
							} );
						};
					} 
				}
				else alert(response);
				})
				.fail(function(jqXHR) {
					if (isJSON(jqXHR.responseText)) {
						res=JSON.parse(jqXHR.responseText);
						MyModal(res.title, res.message);
						if (res.http_response_code>=400 && sessionStorage.getItem('token')) {
							setTimeout(function() {
								sessionStorage.clear();
								window.location.href='index.html';
							}, 3000);	
						}
					} 
					else MyModal("Error", jqXHR.responseText);
				})
				.always(function() {
					$('#submitBtn').html("Retrieve association rules");
				});
			});


		});

		function GetDatasetFilelist() {
			var formData = new FormData();
			if (sessionStorage.getItem('token')) {
				formData.set("token",sessionStorage.getItem('token'));
			}
			else {
				MyModal("Error", "You are not signed in!!! Please sign in/up");
				return;
			}

			$.ajax({
				type: 'POST' ,
				url: 'phpfunctions/retrieveDatasetFilelist.php',
				contentType: false,
                cache: false,
                processData:false ,
			    data: formData
			}) 	
			.done(function(response) {
				if (isJSON(response)) {
					res=JSON.parse(response);
					try {
						str='<option value="" disabled selected >Choose a dataset or dblclick to upload a new</option>';
						res.forEach(function(data, index){
							str += '<option value="' + data.datasetType + data.filename + '">(' + data.datasetType + ') ' + data.filename + '</option>'   
						});
						$("#dataset").html(str);
					}
					catch(err) {
						MyModal("Error", err.message);
					}
				}
				else {
					MyModal("Error", response);
				}
			}).fail(function( jqXHR, textStatus, thrownError ) {
				if (jqXHR.responseText) {
					if (isJSON(jqXHR.responseText)) {
						res=JSON.parse(jqXHR.responseText);
						MyModal(res.title + '(' + res.http_response_code + ')', res.message);
						if (res.http_response_code>=400 && sessionStorage.getItem('token')) {
							setTimeout(function() {
								sessionStorage.clear();
								window.location.href='index.html';
							}, 3000);	
						}
					}
					else alert(jqXHR.responseText);
				} else {
					MyModal("association rules",'Unknown error occured!');
				}
			});
		};

        // It handles the footer when the size of the window changes.
        function M_F() {
			if ($(window).width() <= 600) {
				$('.udfwidth').css("width", "98%");
			}
			else if ($(window).width() > 600 && $(window).width() <= 1500) {
				var pos1=Math.round(Math.abs($(window).width()-1500)*0.055+50);
				$('.udfwidth').css("width", pos1 + "%");
			}
			else {	
				$('.udfwidth').css("width", "50%");
			}
			style="width: 329px;"
            if ($(window).width() <= 800 || $(window).height() <= 600) {
                $('#c-footer').removeClass('fixed-bottom');
            }
            else {
                $('#c-footer').addClass('fixed-bottom')
            }
        };

        // handle the interface when guest or logged in
        function VT() {
            if (sessionStorage.getItem('token') && sessionStorage.getItem('token')!='0') {
                $('#SignUp').hide();
				$('#SignIn').hide();
                if (sessionStorage.getItem('username')) {
                    $('#person').html('<img src="images/person24.png" alt="p">' + sessionStorage.getItem('username'));
                    $('#person').show;
                } else {
                    $('#person').hide;
                }                    
                $('#sdropdown').show();
            } else {
                $('#SignUp').show();
                $('#SignIn').show();
                $('#sdropdown').hide();
            }
        };

        $( window ).resize(function() {
            M_F();
        });		
		
		function UploadDataset() {
			if ($('#uploadDatasetform').is(":visible")) {
				$('#uploadDatasetform').hide( "slow" );
			}
			else {
				$('#uploadDatasetform').show( "slow" );
			}
		};

		function deletecurrentDataset() {
			if (!sessionStorage.getItem('token')) {
				MyModal("Error", "You are not signed in!!! Please sign in/up");
				setTimeout(function() {
								sessionStorage.clear();
								window.location.href='index.html';
							}, 3000);	
				return;
			}

			var x = document.getElementById("dataset");
			if (!x.value) {
				MyModal("Information","No dataset to delete.");
				return;
			}
			if (confirm("Are you sure you want to delete dataset " + x.value.substr(1) + ";")){
				var formData = new FormData();
				formData.set("token",sessionStorage.getItem('token'));
				formData.set("dataset",x.value);
				$.ajax({
					type: 'POST' ,
					url: 'phpfunctions/deleteDataset.php',
					data: formData,
					contentType: false,
                	cache: false,
                	processData:false
				}) 	
				.done(function(response) {
					if (isJSON(response)) {
						res=JSON.parse(response);
						try {
							MyModal(res.title, res.message);
							GetDatasetFilelist();
						}
						catch(err) {
							MyModal("Error", err.message);
						}
					}
					else {
						MyModal("Error", response);
					}
				}).fail(function( jqXHR, textStatus, thrownError ) {
					if (jqXHR.responseText) {
						if (isJSON(jqXHR.responseText)) {
							res=JSON.parse(jqXHR.responseText);
							MyModal(res.title + '(' + res.http_response_code + ')', res.message);
							if (res.http_response_code>=400) {
								setTimeout(function() {
									sessionStorage.clear();
									window.location.href='index.html';
								}, 3000);	
							}
						}
						else alert(jqXHR.responseText);
					} else {
						MyModal("association rules",'Unknown error occured!');
					}
				});
			}
		};

		function retrieveInputParameters() {
			if (!sessionStorage.getItem('token')) {
				MyModal("Error", "You are not signed in!!! Please sign in/up");
				setTimeout(function() {
								sessionStorage.clear();
								window.location.href='index.html';
							}, 3000);	
				return;
			}

			var x = document.getElementById("dataset");
			if (!x.value) {
				return;
			}

			var formData = new FormData();
			formData.set("token",sessionStorage.getItem('token'));
			formData.set("dataset",x.value);
			$.ajax({
				type: 'POST' ,
				url: 'phpfunctions/retrieveInputParameters.php',
				data: formData,
				contentType: false,
				cache: false,
				processData:false
			}) 	
			.done(function(response) {
				if (isJSON(response)) {
					res=JSON.parse(response);
					try {
						if (res.http_response_code) {
							MyModal(res.title, res.message);
							return;
						}
						if (res.min_support) {
							var x = document.getElementById("min_support");
							alert(x.innerHTML);
							x.innerHTML=res.min_support;
						}
					}
					catch(err) {
						MyModal("Error", err.message);
					}
				}
				else {
					MyModal("Error", response);
				}
			}).fail(function( jqXHR, textStatus, thrownError ) {
				if (jqXHR.responseText) {
					if (isJSON(jqXHR.responseText)) {
						res=JSON.parse(jqXHR.responseText);
						MyModal(res.title, res.message);
						if (res.http_response_code>=400) {
							setTimeout(function() {
								sessionStorage.clear();
								window.location.href='index.html';
							}, 3000);	
						}
					}
					else alert(jqXHR.responseText);
				} else {
					MyModal("association rules",'Unknown error occured!');
				}
			});

		};



		//Load & delete filters ...start
		// function SelectFilter() {
				
		// 	//request data from php
		// 	var token = sessionStorage.getItem('token');
		// 	$.post('/phpfunctions/loadfiltersname.php', {
		// 		token: token
		// 	}, function(data) { //data from php
		// 		if (data != "0 results"){
		// 			data = JSON.parse(data);
		// 			$('#Selfilters').empty();
		// 			$('#Selfilters').append('<option value="" selected disabled >select filter</option>'); //Default option
		// 			data.forEach(function(FilterName){ //fill select options
		// 				$('#Selfilters').append("<option id='" + FilterName.FilterName + "' value='"+ FilterName.FilterName + "'>"+ FilterName.FilterName + "   /   " + FilterName.FilterDate +"</option>");
		// 			});
		// 		}
		// 		else {
		// 			$('#Selfilters').empty();
		// 			$('#Selfilters').append('<option value="" selected disabled >select filter</option>'); //Default option
		// 		}		
		// 	});
			
		// 	$( "#loadfilterdialog" ).show();
		// 	$( "#loadfilterdialog" ).dialog({
		// 		buttons: {
		// 			"Load filter": function() {
		// 				//get selection
		// 				var doc = document.getElementById('Selfilters');
		// 				var FilterName = doc.options[doc.selectedIndex].value;
		// 				//request data from php
		// 				var token = sessionStorage.getItem('token');
		// 				if (FilterName != ""){
		// 					$.post('/phpfunctions/loadfilter.php', {
		// 						token: token,
		// 						FilterName: FilterName
		// 					}, function(data) { //data from php
		// 						data = JSON.parse(data);
		// 						//fill data
		// 						data.forEach(function(Filter){ //fill form filters
		// 							document.getElementsByName('direction')[(Filter.FilterOneway-1)].checked=true;
		// 							if (Filter.FilterNonStop == 'on'){
		// 								document.getElementById('nonstop').checked = true;
		// 							}
		// 							else {
		// 								document.getElementById('nonstop').checked = false;
		// 							}
									
		// 							document.getElementById('origin_descr').value = Filter.FilterOrigin;
		// 							var matches = Filter.FilterOrigin.match(/\[(.*?)\]/);
		// 							if (matches) {
		// 								var submatch = matches[1];
		// 							}							
		// 							document.getElementById('origin').value = submatch;
									
		// 							document.getElementById('destination_descr').value = Filter.FilterDestination;
		// 							var matches = Filter.FilterDestination.match(/\[(.*?)\]/);
		// 							if (matches) {
		// 								var submatch = matches[1];
		// 							}								
		// 							document.getElementById('destination').value = submatch;

		// 							//parse tomorrow for comparison
		// 							var today = new Date();
		// 							var dd = today.getDate()+1;
		// 							var mm = today.getMonth()+1; //January is 0!
		// 							var yyyy = today.getFullYear();
		// 							if(dd<10) {
		// 								dd = '0'+dd
		// 							} 
		// 							if(mm<10) {
		// 								mm = '0'+mm
		// 							} 
		// 							tomorrow =  yyyy + '-' + mm + '-' + dd;

		// 							if (Filter.FilterDDate != '0000-00-00'){
		// 								if (Filter.FilterDDate<tomorrow) {
		// 									MyModal("Information","Departure date has passed. Tomorrow date will be used instead.");
		// 									midDate=tomorrow;
		// 								} else {
		// 									midDate = Filter.FilterDDate;
		// 								}
		// 								var mySQLDate = midDate.split("-");
		// 								var myJSDate =  mySQLDate[2]+ "/" +mySQLDate[1]+ "/" +mySQLDate[0];
		// 								document.getElementById('departure_date').value = myJSDate;
		// 								document.getElementById('ddate').value = midDate;
		// 							}
		// 							else {
		// 								document.getElementById('departure_date').value = "";
		// 							}
									
		// 							if (Filter.FilterRDate != '0000-00-00' && Filter.FilterOneway == '2'){
		// 								if (Filter.FilterRDate<tomorrow) {
		// 									MyModal("Information","Arrival date has passed. Tomorrow date will be used instead.");
		// 									midDate=tomorrow;
		// 								} else {
		// 									midDate = Filter.FilterRDate;
		// 								}
		// 								var mySQLDate = midDate.split("-");
		// 								var myJSDate =  mySQLDate[2]+ "/" +mySQLDate[1]+ "/" +mySQLDate[0];
		// 								document.getElementById("return_date").type = "text";
		// 								document.getElementById('return_date').value = myJSDate;
		// 								document.getElementById('rdate').value = midDate;
		// 							}
		// 							else {
		// 								document.getElementById("return_date").type = "hidden";
		// 								document.getElementById('return_date').value = "";
		// 							}
									
		// 						});						
		// 					});
		// 					$( this ).dialog( "close" );
		// 				}
		// 				else {
		// 					MyModal("Association rules mining","Nothing to load");
		// 				}
		// 			},
		// 			"Delete filter": function() {
		// 				//get selection
		// 				var doc = document.getElementById("Selfilters");
		// 				var FilterName = doc.options[doc.selectedIndex].value;
		// 				if (FilterName != ""){
		// 					//request data from php
		// 					var token = sessionStorage.getItem('token');
		// 					$.post('/phpfunctions/deletefilter.php', {
		// 						token: token,
		// 						FilterName: FilterName
		// 					}, function(data) { //data from php
		// 						MyModal("Association rules mining",data);
		// 					});
		// 					$( this ).dialog( "close" );
		// 				}
		// 				else { //trying to delete default selection option
		// 					MyModal("Association rules mining","Nothing to delete");
		// 				}
		// 			}
		// 		},
		// 		clickOutside: true, // clicking outside the dialog will close it
		// 		clickOutsideTrigger: "#Selfilters"  // Element (id or class) that triggers the dialog opening 			
		// 	});
		// }
		//Load & delete filters ...end
	
// 		function CheckFilters() {
// 			if ($('#direction').val()!=1 && $('#direction').val()!=2) {
// 				MyModal("Wrong filters!", "Declare One way or round trip please!");
// 				return;
// 			}
// 			if (!$('#origin_descr').val()) {
// 				MyModal("Wrong filters!", "Please choose departure airport please!");
// 				return;
// 			}
// 			if (!$('#departure_date').val()) {
// 				MyModal("Wrong filters!", "Please choose departure date please!");
// 				return;
// 			}
// 			if (!$('#destination_descr').val()) {
// 				MyModal("Wrong filters!", "Please choose destination airport please!");
// 				return;
// 			}
// 			if ($('#direction').val()==2) {
// 				if (!$('#return_date').val()) {
// 					MyModal("Wrong filters!", "Please choose return date please!");
// 					return;
// 				}
// 			}
// 			$('#MyPrompt').modal('show')
// 		};

// 		//Save filter ...start
// 		function SaveFilter(SaveFilterName) {
// 			var msg;
// 			var format = /[!@#$%^&*()+\-=\[\]{};':"\\|,.<>\/?]/;
// 			var illegalC;
// 			//var SaveFilterName = prompt("Give a name to save this record");
// 			if (SaveFilterName != null) {
// 				SaveFilterName = SaveFilterName.trim();
// 				if(format.test(SaveFilterName)){
// 					illegalC = "1";
// 				} else {
// 					illegalC = "0";
// 				}
// 				if (SaveFilterName == null || SaveFilterName == "" ){
// 				msg = "Please fill a name";
// 				MyModal("Association rules mining",msg);
// 				}
// 				else if (illegalC == "1"){
// 					msg = "Please use only letters and numbers without special characters";
// 					MyModal("Association rules mining",msg);
// 					}
// 				else {
// 					var token = sessionStorage.getItem('token');
// //					var playload = JSON.parse(atob(token.split('.')[1]));
// //					var email = playload;

// 					var direction = $('input[name="direction"]:checked').val();
// 					var nonstop = $('input[name="nonstop"]:checked').val();
// 					if (nonstop != "on") {
// 						nonstop = "off";
// 						}
				
// 					var origin_descr = $('input[name="origin_descr"]').val();
// 					var destination_descr = $('input[name="destination_descr"]').val();
// 					var departure_date = $('input[name="departure_date"]').val();
// 					var return_date = $('input[name="return_date"]').val();
					
// 					$.post('/phpfunctions/savefilter.php', {
// 						token: token,
// 						SaveFilterName: SaveFilterName,
// 						direction: direction,
// 						nonstop: nonstop,
// 						origin_descr: origin_descr,
// 						destination_descr: destination_descr,
// 						departure_date: departure_date,
// 						return_date: return_date
// 					}, function(data) {
// 						MyModal("Association rules mining",data);
// 					});
// 				}
// 			}

// 		}

	</script>
	<!-- Save filter ...end -->

	
</head>

<body>

	<nav class="navbar navbar-expand-sm navbar-dark bg-dark">
		<a id="navbar-brand" class="navbar-brand d-none d-sm-block" data-toggle="modal" onclick="credits()" data-target="#Credits" href="#">
			<img class="d-inline-block mr-1" src="./images/basketwhite.svg" width="24" height="24" alt="">Association rules mining
        </a>		
		<ul class="navbar-nav mr-auto">
			<li class="nav-item">
				<a class="nav-link" href="index.html">Home</a>
			</li>
			<li class="nav-item">
				<a class="nav-link active">Rules search</a>
			</li>
		</ul>
		<ul class="navbar-nav ml-auto">
			<li id="Rate" class="nav-item">
				<a class="nav-link" href="https://docs.google.com/forms/d/e/1FAIpQLScLYL2nig3jOst4QNx-ojEawqks9j3yrVP0AHSkBTIXJAEr0w/viewform" target="_blank">Rate us!</a>
			</li>			
			<li id="SignUp" class="nav-item">
				<a class="nav-link" href="SignUp.html">Sign Up</a>
			</li>
			<li id="SignIn" class="nav-item active">
				<a class="nav-link" href="Login.html">Sign In</a>
			</li>
			<li id=sdropdown class="nav-item dropdown">
				<a class="nav-item nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
					<img src="images/settings24.png" alt="">
				</a>
				<div class="dropdown-menu dropdown-menu-right dropdown-menu-dark" aria-labelledby="navbarDropdown">
                    <p id="person" class="text-primary text-center"></p>
					<div class="dropdown-divider"></div>
					<a id="uploadDatasetDD" class="dropdown-item" onclick="UploadDataset()" href="#"><img src="images/upload24Black.png" alt=""> Upload dataset</a>
					<a id="savefilters" class="dropdown-item" onclick="CheckFilters()"    href="#"><img src="images/save24.png"     alt=""> Save search filters</a>
					<a id="loadfilters" class="dropdown-item" onclick="SelectFilter()"    href="#"><img src="images/load24.png"     alt=""> Load search filters</a>
					<div class="dropdown-divider"></div>
					<a id="settings"    class="dropdown-item" href="profile.html"><img src="images/settings24.png" alt="">Profile</a>
					<a id="SignOut"     class="dropdown-item" href="#"><img src="images/signout24.png" alt=""> Sign out</a>
				</div>
			</li>			
		</ul>
	</nav>
	
	<br>

	<form id="uploadDatasetform" action="phpfunctions/uploadDataset.php" method="post" enctype="multipart/form-data" style="display: none">
		<div class="udfwidth mx-auto border rounded p-2">
			<div class="form-row">
				<div class="col-11">
					<div class="form-row">
						<div class="col-5">
							<label class="float-right">Select dataset to upload:</label>
						</div>
						<div class="col-7">
							<input type="file" class="form-control-file" name="fileToUpload" id="fileToUpload" accept=".csv, .txt" >
						</div>						
					</div>
					<div class="form-row">
						<div class="col-1">
							<button type="button" class="btn btn-sm" id="hideUpload" onclick="toggleDisplay('#uploadDatasetform')" data-trigger="hover" data-toggle="tooltip" title="Hides upload new dataset section"><img src="./images/close24grey.png" width="24" height="24" alt="">	</button>
						</div>
						<div class="col-1">
							<!-- <button type="button" class="btn btn-sm" data-toggle="collapse" data-target="#collapseInfo" aria-expanded="false" aria-controls="collapseInfo" id="helpForDatasetType" data-trigger="hover" data-toggle="tooltip" title="Information for the dataset type"><img src="./images/help24grey.png" width="24" height="24" alt="">	</button> -->
							<button type="button" class="btn btn-sm" onclick="toggleDisplay('#infoForDS')" id="helpForDatasetType" data-trigger="hover" data-toggle="tooltip" title="Information for the dataset type"><img src="./images/help24grey.png" width="24" height="24" alt="">	</button>
						</div>
						<div class="col-3">
							<label class="col-form-label float-right">dataset type:</label>
						</div>
						<div class="col-7">
							<select id="datasetType" class="browser-default custom-select" data-html="true" data-trigger="hover" data-toggle="tooltip" 
							    title="<p>1) Market Basket list<br>2) Order/Invoice detail<br>3) Sparce item Dataset<br>4) Columns with multiple nomimal values</p>"
						    >
								<option value="" disabled selected>Choose a dataset type</option>
								<option value="1">Market basket list</option>
								<option value="2">Order/Invoice detail</option>
								<option value="3">Sparce item dataset</option>
								<option value="4">Multiple nomimal values</option>
							</select>
						</div>
					</div>		
				</div>
				<div class="col-1 border border-primary rounded p-1	">
					<button class="btn btn-primary btn-inline" type="submit" name="submit" style="height:100%; width:100%" id="uploadButton" data-trigger="hover" data-toggle="tooltip" title="Upload the Dataset!"><img src="./images/upload32White.png" width="32" height="32" alt=""></button>
				</div>
			</div>
		</div>
	</form>		

	<!-- <div class="collapse" id="collapseInfo"> -->
		<div id="infoForDS" class="udfwidth mx-auto border rounded p-2" style="display:none">
			<h2>Supported dataset types</h2>
			<br>
			<p><b>1) Market Basket list.</b> No header is expected, The number of columns is undefined (Default). 
			If header row exists, then participant columns must be declared in extra paramaters field (comma separated) starting from the 2nd parameter, 
			In 1st parameter the string representing the absent item must be declared. If absent item is nothing or not exists then assign '' or 'nan'.
			</br> 
			<b>2) Order/Invoice detail.</b> Header line is mandatory in that type. Number of columns is fixed in the dataset. 
			In extra paramaters field (comma separated), 1st parameter represents the primary key column while 2nd parameter represents the items column and are both mandatory.
			</br> 
			<b>3) Sparce item Dataset.</b> Header line is mandatory in that type. Number of columns is fixed in the dataset. 
			Item columns are mandatory to be declared from the 2nd parameter In extra paramaters field (comma separated).
			In 1st parameter, the string of absent item must be declared!!! If absent item is nothing then assign '' or 'nan'. 
			</br>
			<b>4) Columns with multiple categorized values.</b> Header line is optional. 
			Number of columns is fixed, optionally, items columns are expected in extra paramaters field (comma separated) in case that header line exists.
		</div>
	<!-- </div> -->

	<form id="retrieveRules" action="phpfunctions/retrieveRules.php" method="post" >
		<div class="udfwidth mx-auto border rounded p-2">
			<div class="form-row">
				<div class="col-9">	
					<label for="dataset">Select dataset or <a href="#" onclick="toggleDisplay('#uploadDatasetform');return false;" data-toggle="tooltip" title="Upload a new dataset on our server. Uploaded dataset limit is 10">upload</a> one:</label>			
				</div>
				<div class="col-2">	
					<label for="separator">Separator</label>			
				</div>
				<div class="col-1">
					<button type="button" class="btn mt-n2 float-right" onclick="toggleDisplay('#infoForDS')" id="helpForDatasetType" data-trigger="hover" data-toggle="tooltip" title="Information for the dataset type"><img src="./images/help24grey.png" width="24" height="24" alt="">	</button>
				</div>
			</div>
			<div class="form-row">
				<div class="col-9">	
					<select id="dataset" name="dataset" class="form-control browser-default custom-select" data-trigger="hover" data-toggle="tooltip" title="Pick the dataset for which association rules would be generated" onchange="retrieveInputParameters()">
						<option value="" disabled selected>Choose a dataset from the list</option>
					</select>
				</div>	
				<div class="col-2">	
					<input type="text" id="separator" name="separator" class="form-control" data-trigger="hover" data-toggle="tooltip" title="the separator of the items in the CSV file. The most common characters are (,) and (;)" placeholder=",">		
				</div>
				<div class="col-1">	
					<button type="button" id="deleteDataset" class="btn mt-n2 float-right" data-trigger="hover" data-toggle="tooltip" title="Delete current dataset"  onclick="deletecurrentDataset()">
						<img src="images/delete32grey.png" width="24" height="24" alt="">
					</button>
				</div>
			</div>	
		</div>
		<div class="udfwidth mx-auto border rounded p-2">
			<div class="form-row">
				<div class="col-6">		
					<label for="min_support">Minimum support</label>
				</div>
				<div class="col-6">
					<label for="min_confidence">Minimum confidence</label>
				</div>
			</div>
			<div class="form-row">
				<div class="col-6">		
					<input type="text" id="min_support" name="min_support" class="form-control" data-trigger="hover" data-toggle="tooltip" title="The minimum support that each association rule should have" placeholder="0.01">
				</div>
				<div class="col-6">	
					<input type="text" id="min_confidence" name="min_confidence" class="form-control" data-trigger="hover" data-toggle="tooltip" title="The minimum confidence that each association rule should have" placeholder="0.2">
				</div>
			</div>
			<div class="form-row">
				<div class="col-6">		
					<label for="min_lift">Minimum lift</label>
				</div>
				<div class="col-6">
					<label for="max_length">Maximum rules items</label>
				</div>
			</div>
			<div class="form-row">
				<div class="col-6">		
					<input type="text" id="min_lift" name="min_lift" class="form-control" data-trigger="hover" data-toggle="tooltip" title="The minimum lift that each association rule should have" placeholder="1.5">
				</div>
				<div class="col-6">	
					<input type="text" id="max_length" name="max_length" class="form-control" data-trigger="hover" data-toggle="tooltip" title="The maximum items each association rule consist of" placeholder="2">
				</div>
			</div>	
			<div class="form-col">	
				<label for="extra parameters">Extra parameters / item names</label>
			</div>
			<div class="form-col">	
				<input type="text" id="extra_parameters" name="extra_parameters" class="form-control" data-trigger="hover" data-toggle="tooltip" title="The maximum items each association rule consist of" placeholder="special data (e.g item names)">
			</div>
			<div class="p-2 mx-auto" style="width: 300px;">
				<button id="submitBtn" type="submit" class="btn btn-primary ">Retrieve association rules</button>
			</div>
		</div>	
	</form>

	<br>
	<br>

	<div id="showResults" class="table-responsive dataTables_wrapper dt-bootstrap4 ">
		<table id="showResultsTbl" class="table table-striped table-bordered table-hover table-sm" style="width:100%">
			<thead class="thead-dark">
			</thead>
		</table>
  </div>
  
  <br>
  <br>
  <br>
	
	<footer>
        <nav id="c-footer" class="navbar fixed-bottom navbar-expand-lg navbar-dark bg-dark">
            <span class="text-muted">Association rules mining based on Apriori algorithm &middot; MSc in Web Intelligence &copy; 2019-2020</span>
        </nav>
	</footer> 

</body>
</html>
