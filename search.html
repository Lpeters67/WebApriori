<!DOCTYPE html>
<html>
<head>

	<!-- Global site tag (gtag.js) - Google Analytics -->
	<!-- <script async src="https://www.googletagmanager.com/gtag/js?id=UA-130197414-1"></script>
	<script>
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'UA-130197414-1');
	</script> -->

	<meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <!-- Bootstrap CSS -->
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <link rel="icon" type="image/png" href="images/basketwhite.svg"/>

    <link rel="stylesheet" href="css/styles.css" type="text/css" />

	<script src="scripts/jquery-3.4.1.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

	<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css"/>
 
	<script type="text/javascript" src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
	<!-- <script type="text/javascript" src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script> -->


	<script src="scripts/scripts.js"></script>

    <title>Association rules mining</title>

	<script>

var dataSet = [
    [ "Tiger Nixon", "System Architect", "Edinburgh", "5421", "2011/04/25", "$320,800" ],
    [ "Garrett Winters", "Accountant", "Tokyo", "8422", "2011/07/25", "$170,750" ],
    [ "Ashton Cox", "Junior Technical Author", "San Francisco", "1562", "2009/01/12", "$86,000" ],
    [ "Cedric Kelly", "Senior Javascript Developer", "Edinburgh", "6224", "2012/03/29", "$433,060" ],
    [ "Airi Satou", "Accountant", "Tokyo", "5407", "2008/11/28", "$162,700" ],
    [ "Brielle Williamson", "Integration Specialist", "New York", "4804", "2012/12/02", "$372,000" ],
    [ "Herrod Chandler", "Sales Assistant", "San Francisco", "9608", "2012/08/06", "$137,500" ],
    [ "Rhona Davidson", "Integration Specialist", "Tokyo", "6200", "2010/10/14", "$327,900" ],
    [ "Colleen Hurst", "Javascript Developer", "San Francisco", "2360", "2009/09/15", "$205,500" ],
    [ "Sonya Frost", "Software Engineer", "Edinburgh", "1667", "2008/12/13", "$103,600" ],
    [ "Jena Gaines", "Office Manager", "London", "3814", "2008/12/19", "$90,560" ],
    [ "Quinn Flynn", "Support Lead", "Edinburgh", "9497", "2013/03/03", "$342,000" ],
    [ "Charde Marshall", "Regional Director", "San Francisco", "6741", "2008/10/16", "$470,600" ],
    [ "Haley Kennedy", "Senior Marketing Designer", "London", "3597", "2012/12/18", "$313,500" ],
    [ "Tatyana Fitzpatrick", "Regional Director", "London", "1965", "2010/03/17", "$385,750" ],
    [ "Michael Silva", "Marketing Designer", "London", "1581", "2012/11/27", "$198,500" ],
    [ "Paul Byrd", "Chief Financial Officer (CFO)", "New York", "3059", "2010/06/09", "$725,000" ],
    [ "Gloria Little", "Systems Administrator", "New York", "1721", "2009/04/10", "$237,500" ],
    [ "Bradley Greer", "Software Engineer", "London", "2558", "2012/10/13", "$132,000" ],
    [ "Dai Rios", "Personnel Lead", "Edinburgh", "2290", "2012/09/26", "$217,500" ],
    [ "Jenette Caldwell", "Development Lead", "New York", "1937", "2011/09/03", "$345,000" ],
    [ "Yuri Berry", "Chief Marketing Officer (CMO)", "New York", "6154", "2009/06/25", "$675,000" ],
    [ "Caesar Vance", "Pre-Sales Support", "New York", "8330", "2011/12/12", "$106,450" ],
    [ "Doris Wilder", "Sales Assistant", "Sydney", "3023", "2010/09/20", "$85,600" ],
    [ "Angelica Ramos", "Chief Executive Officer (CEO)", "London", "5797", "2009/10/09", "$1,200,000" ],
    [ "Gavin Joyce", "Developer", "Edinburgh", "8822", "2010/12/22", "$92,575" ],
    [ "Jennifer Chang", "Regional Director", "Singapore", "9239", "2010/11/14", "$357,650" ],
    [ "Brenden Wagner", "Software Engineer", "San Francisco", "1314", "2011/06/07", "$206,850" ],
    [ "Fiona Green", "Chief Operating Officer (COO)", "San Francisco", "2947", "2010/03/11", "$850,000" ],
    [ "Shou Itou", "Regional Marketing", "Tokyo", "8899", "2011/08/14", "$163,000" ],
    [ "Michelle House", "Integration Specialist", "Sydney", "2769", "2011/06/02", "$95,400" ],
    [ "Suki Burks", "Developer", "London", "6832", "2009/10/22", "$114,500" ],
    [ "Prescott Bartlett", "Technical Author", "London", "3606", "2011/05/07", "$145,000" ],
    [ "Gavin Cortez", "Team Leader", "San Francisco", "2860", "2008/10/26", "$235,500" ],
    [ "Martena Mccray", "Post-Sales support", "Edinburgh", "8240", "2011/03/09", "$324,050" ],
    [ "Unity Butler", "Marketing Designer", "San Francisco", "5384", "2009/12/09", "$85,675" ]
];

var dataset1 = 
{
  "data": [
    {
      "name": "Tiger Nixon",
      "hr": {
        "position": "System Architect",
        "salary": "$320,800",
        "start_date": "2011/04/25"
      },
      "contact": [
        "Edinburgh",
        "5421"
      ]
    },
    {
      "name": "Garrett Winters",
      "hr": {
        "position": "Accountant",
        "salary": "$170,750",
        "start_date": "2011/07/25"
      },
      "contact": [
        "Tokyo",
        "8422"
      ]
    },
    {
      "name": "Ashton Cox",
      "hr": {
        "position": "Junior Technical Author",
        "salary": "$86,000",
        "start_date": "2009/01/12"
      },
      "contact": [
        "San Francisco",
        "1562"
      ]
    },
    {
      "name": "Cedric Kelly",
      "hr": {
        "position": "Senior Javascript Developer",
        "salary": "$433,060",
        "start_date": "2012/03/29"
      },
      "contact": [
        "Edinburgh",
        "6224"
      ]
    },
    {
      "name": "Airi Satou",
      "hr": {
        "position": "Accountant",
        "salary": "$162,700",
        "start_date": "2008/11/28"
      },
      "contact": [
        "Tokyo",
        "5407"
      ]
    },
    {
      "name": "Brielle Williamson",
      "hr": {
        "position": "Integration Specialist",
        "salary": "$372,000",
        "start_date": "2012/12/02"
      },
      "contact": [
        "New York",
        "4804"
      ]
    },
    {
      "name": "Herrod Chandler",
      "hr": {
        "position": "Sales Assistant",
        "salary": "$137,500",
        "start_date": "2012/08/06"
      },
      "contact": [
        "San Francisco",
        "9608"
      ]
    },
    {
      "name": "Rhona Davidson",
      "hr": {
        "position": "Integration Specialist",
        "salary": "$327,900",
        "start_date": "2010/10/14"
      },
      "contact": [
        "Tokyo",
        "6200"
      ]
    },
    {
      "name": "Colleen Hurst",
      "hr": {
        "position": "Javascript Developer",
        "salary": "$205,500",
        "start_date": "2009/09/15"
      },
      "contact": [
        "San Francisco",
        "2360"
      ]
    },
    {
      "name": "Sonya Frost",
      "hr": {
        "position": "Software Engineer",
        "salary": "$103,600",
        "start_date": "2008/12/13"
      },
      "contact": [
        "Edinburgh",
        "1667"
      ]
    },
    {
      "name": "Jena Gaines",
      "hr": {
        "position": "Office Manager",
        "salary": "$90,560",
        "start_date": "2008/12/19"
      },
      "contact": [
        "London",
        "3814"
      ]
    },
    {
      "name": "Quinn Flynn",
      "hr": {
        "position": "Support Lead",
        "salary": "$342,000",
        "start_date": "2013/03/03"
      },
      "contact": [
        "Edinburgh",
        "9497"
      ]
    },
    {
      "name": "Charde Marshall",
      "hr": {
        "position": "Regional Director",
        "salary": "$470,600",
        "start_date": "2008/10/16"
      },
      "contact": [
        "San Francisco",
        "6741"
      ]
    },
    {
      "name": "Haley Kennedy",
      "hr": {
        "position": "Senior Marketing Designer",
        "salary": "$313,500",
        "start_date": "2012/12/18"
      },
      "contact": [
        "London",
        "3597"
      ]
    },
    {
      "name": "Tatyana Fitzpatrick",
      "hr": {
        "position": "Regional Director",
        "salary": "$385,750",
        "start_date": "2010/03/17"
      },
      "contact": [
        "London",
        "1965"
      ]
    },
    {
      "name": "Michael Silva",
      "hr": {
        "position": "Marketing Designer",
        "salary": "$198,500",
        "start_date": "2012/11/27"
      },
      "contact": [
        "London",
        "1581"
      ]
    },
    {
      "name": "Paul Byrd",
      "hr": {
        "position": "Chief Financial Officer (CFO)",
        "salary": "$725,000",
        "start_date": "2010/06/09"
      },
      "contact": [
        "New York",
        "3059"
      ]
    },
    {
      "name": "Gloria Little",
      "hr": {
        "position": "Systems Administrator",
        "salary": "$237,500",
        "start_date": "2009/04/10"
      },
      "contact": [
        "New York",
        "1721"
      ]
    },
    {
      "name": "Bradley Greer",
      "hr": {
        "position": "Software Engineer",
        "salary": "$132,000",
        "start_date": "2012/10/13"
      },
      "contact": [
        "London",
        "2558"
      ]
    },
    {
      "name": "Dai Rios",
      "hr": {
        "position": "Personnel Lead",
        "salary": "$217,500",
        "start_date": "2012/09/26"
      },
      "contact": [
        "Edinburgh",
        "2290"
      ]
    },
    {
      "name": "Jenette Caldwell",
      "hr": {
        "position": "Development Lead",
        "salary": "$345,000",
        "start_date": "2011/09/03"
      },
      "contact": [
        "New York",
        "1937"
      ]
    },
    {
      "name": "Yuri Berry",
      "hr": {
        "position": "Chief Marketing Officer (CMO)",
        "salary": "$675,000",
        "start_date": "2009/06/25"
      },
      "contact": [
        "New York",
        "6154"
      ]
    },
    {
      "name": "Caesar Vance",
      "hr": {
        "position": "Pre-Sales Support",
        "salary": "$106,450",
        "start_date": "2011/12/12"
      },
      "contact": [
        "New York",
        "8330"
      ]
    },
    {
      "name": "Doris Wilder",
      "hr": {
        "position": "Sales Assistant",
        "salary": "$85,600",
        "start_date": "2010/09/20"
      },
      "contact": [
        "Sidney",
        "3023"
      ]
    },
    {
      "name": "Angelica Ramos",
      "hr": {
        "position": "Chief Executive Officer (CEO)",
        "salary": "$1,200,000",
        "start_date": "2009/10/09"
      },
      "contact": [
        "London",
        "5797"
      ]
    },
    {
      "name": "Gavin Joyce",
      "hr": {
        "position": "Developer",
        "salary": "$92,575",
        "start_date": "2010/12/22"
      },
      "contact": [
        "Edinburgh",
        "8822"
      ]
    },
    {
      "name": "Jennifer Chang",
      "hr": {
        "position": "Regional Director",
        "salary": "$357,650",
        "start_date": "2010/11/14"
      },
      "contact": [
        "Singapore",
        "9239"
      ]
    },
    {
      "name": "Brenden Wagner",
      "hr": {
        "position": "Software Engineer",
        "salary": "$206,850",
        "start_date": "2011/06/07"
      },
      "contact": [
        "San Francisco",
        "1314"
      ]
    },
    {
      "name": "Fiona Green",
      "hr": {
        "position": "Chief Operating Officer (COO)",
        "salary": "$850,000",
        "start_date": "2010/03/11"
      },
      "contact": [
        "San Francisco",
        "2947"
      ]
    },
    {
      "name": "Shou Itou",
      "hr": {
        "position": "Regional Marketing",
        "salary": "$163,000",
        "start_date": "2011/08/14"
      },
      "contact": [
        "Tokyo",
        "8899"
      ]
    },
    {
      "name": "Michelle House",
      "hr": {
        "position": "Integration Specialist",
        "salary": "$95,400",
        "start_date": "2011/06/02"
      },
      "contact": [
        "Sidney",
        "2769"
      ]
    },
    {
      "name": "Suki Burks",
      "hr": {
        "position": "Developer",
        "salary": "$114,500",
        "start_date": "2009/10/22"
      },
      "contact": [
        "London",
        "6832"
      ]
    },
    {
      "name": "Prescott Bartlett",
      "hr": {
        "position": "Technical Author",
        "salary": "$145,000",
        "start_date": "2011/05/07"
      },
      "contact": [
        "London",
        "3606"
      ]
    },
    {
      "name": "Gavin Cortez",
      "hr": {
        "position": "Team Leader",
        "salary": "$235,500",
        "start_date": "2008/10/26"
      },
      "contact": [
        "San Francisco",
        "2860"
      ]
    },
    {
      "name": "Martena Mccray",
      "hr": {
        "position": "Post-Sales support",
        "salary": "$324,050",
        "start_date": "2011/03/09"
      },
      "contact": [
        "Edinburgh",
        "8240"
      ]
    },
    {
      "name": "Unity Butler",
      "hr": {
        "position": "Marketing Designer",
        "salary": "$85,675",
        "start_date": "2009/12/09"
      },
      "contact": [
        "San Francisco",
        "5384"
      ]
    },
    {
      "name": "Howard Hatfield",
      "hr": {
        "position": "Office Manager",
        "salary": "$164,500",
        "start_date": "2008/12/16"
      },
      "contact": [
        "San Francisco",
        "7031"
      ]
    },
    {
      "name": "Hope Fuentes",
      "hr": {
        "position": "Secretary",
        "salary": "$109,850",
        "start_date": "2010/02/12"
      },
      "contact": [
        "San Francisco",
        "6318"
      ]
    },
    {
      "name": "Vivian Harrell",
      "hr": {
        "position": "Financial Controller",
        "salary": "$452,500",
        "start_date": "2009/02/14"
      },
      "contact": [
        "San Francisco",
        "9422"
      ]
    },
    {
      "name": "Timothy Mooney",
      "hr": {
        "position": "Office Manager",
        "salary": "$136,200",
        "start_date": "2008/12/11"
      },
      "contact": [
        "London",
        "7580"
      ]
    },
    {
      "name": "Jackson Bradshaw",
      "hr": {
        "position": "Director",
        "salary": "$645,750",
        "start_date": "2008/09/26"
      },
      "contact": [
        "New York",
        "1042"
      ]
    },
    {
      "name": "Olivia Liang",
      "hr": {
        "position": "Support Engineer",
        "salary": "$234,500",
        "start_date": "2011/02/03"
      },
      "contact": [
        "Singapore",
        "2120"
      ]
    },
    {
      "name": "Bruno Nash",
      "hr": {
        "position": "Software Engineer",
        "salary": "$163,500",
        "start_date": "2011/05/03"
      },
      "contact": [
        "London",
        "6222"
      ]
    },
    {
      "name": "Sakura Yamamoto",
      "hr": {
        "position": "Support Engineer",
        "salary": "$139,575",
        "start_date": "2009/08/19"
      },
      "contact": [
        "Tokyo",
        "9383"
      ]
    },
    {
      "name": "Thor Walton",
      "hr": {
        "position": "Developer",
        "salary": "$98,540",
        "start_date": "2013/08/11"
      },
      "contact": [
        "New York",
        "8327"
      ]
    },
    {
      "name": "Finn Camacho",
      "hr": {
        "position": "Support Engineer",
        "salary": "$87,500",
        "start_date": "2009/07/07"
      },
      "contact": [
        "San Francisco",
        "2927"
      ]
    },
    {
      "name": "Serge Baldwin",
      "hr": {
        "position": "Data Coordinator",
        "salary": "$138,575",
        "start_date": "2012/04/09"
      },
      "contact": [
        "Singapore",
        "8352"
      ]
    },
    {
      "name": "Zenaida Frank",
      "hr": {
        "position": "Software Engineer",
        "salary": "$125,250",
        "start_date": "2010/01/04"
      },
      "contact": [
        "New York",
        "7439"
      ]
    },
    {
      "name": "Zorita Serrano",
      "hr": {
        "position": "Software Engineer",
        "salary": "$115,000",
        "start_date": "2012/06/01"
      },
      "contact": [
        "San Francisco",
        "4389"
      ]
    },
    {
      "name": "Jennifer Acosta",
      "hr": {
        "position": "Junior Javascript Developer",
        "salary": "$75,650",
        "start_date": "2013/02/01"
      },
      "contact": [
        "Edinburgh",
        "3431"
      ]
    },
    {
      "name": "Cara Stevens",
      "hr": {
        "position": "Sales Assistant",
        "salary": "$145,600",
        "start_date": "2011/12/06"
      },
      "contact": [
        "New York",
        "3990"
      ]
    },
    {
      "name": "Hermione Butler",
      "hr": {
        "position": "Regional Director",
        "salary": "$356,250",
        "start_date": "2011/03/21"
      },
      "contact": [
        "London",
        "1016"
      ]
    },
    {
      "name": "Lael Greer",
      "hr": {
        "position": "Systems Administrator",
        "salary": "$103,500",
        "start_date": "2009/02/27"
      },
      "contact": [
        "London",
        "6733"
      ]
    },
    {
      "name": "Jonas Alexander",
      "hr": {
        "position": "Developer",
        "salary": "$86,500",
        "start_date": "2010/07/14"
      },
      "contact": [
        "San Francisco",
        "8196"
      ]
    },
    {
      "name": "Shad Decker",
      "hr": {
        "position": "Regional Director",
        "salary": "$183,000",
        "start_date": "2008/11/13"
      },
      "contact": [
        "Edinburgh",
        "6373"
      ]
    },
    {
      "name": "Michael Bruce",
      "hr": {
        "position": "Javascript Developer",
        "salary": "$183,000",
        "start_date": "2011/06/27"
      },
      "contact": [
        "Singapore",
        "5384"
      ]
    },
    {
      "name": "Donna Snider",
      "hr": {
        "position": "Customer Support",
        "salary": "$112,000",
        "start_date": "2011/01/25"
      },
      "contact": [
        "New York",
        "4226"
      ]
    }
  ]
};


		$(function() {

			// initialization of tooltips in page
			$('[data-toggle="tooltip"]').tooltip()

			if (!sessionStorage.getItem('token') || sessionStorage.getItem('token')==0) {
				MyModal("Association rules",'Please Sign in, or Sign up if you are a new user, in order to use our new association rules mining engine!');
				setTimeout(function() {
								sessionStorage.clear();
								window.location.href='index.html';
							}, 4000);	
			}

			if (sessionStorage.getItem('version')) {
				$('#navbar-brand').html('<img class="d-inline-block mr-1" src="./images/basketwhite.svg" width="24" height="24" alt="">Association rules ' +  sessionStorage.getItem('version'));
			}
			else {
				sessionStorage.clear();
				window.location.href='index.html';
			}
			M_F();
			VT();

			GetDatasetFilelist();

			$('#SignOut').click(function() {
				sessionStorage.clear();
				window.location.href='index.html';
			});		

			// Set up an event listener for the contact form.
			$('#uploadDatasetform').submit(function(e) {
				// Stop the browser from submitting the form.
				e.preventDefault();

				//Prepare the data to send
				var formData = new FormData();
				var fileSelect = document.getElementById("fileToUpload");
				if(fileSelect.files && fileSelect.files.length == 1){
                    var file = fileSelect.files[0]
                    formData.set("fileToUpload", file , file.name);
				}
				else {
					MyModal("Information", "You have not chosen a file for upload.<br>Please choose one.");
					return;
				}
				var datasetType = document.getElementById("datasetType");
				if(!datasetType.value){
					MyModal("Information", "You have not chosen datasetType!!!");
					return;
				}
				formData.set("datasetType", datasetType.value);
				if (sessionStorage.getItem('token')) {
					formData.set("token",sessionStorage.getItem('token'));
				}
				else {
					MyModal("Error", "You are not signed in!!! Please sign in/up");
					return;
				}

				// Submit the form using AJAX.
				$.ajax({
					type: 'POST',
					url: $('#uploadDatasetform').attr('action'),
					contentType: false,
                    cache: false,
                    processData:false,
					data: formData
				}).done(function(response) {
					if (isJSON(response)) {
						res=JSON.parse(response);
						if (res.http_response_code==200) {
							MyModal(res.title,res.message);
							GetDatasetFilelist();
						} else {
							MyModal(res.title, res.message);
						}
					}
					else alert(response);
				}).fail(function( jqXHR, textStatus, thrownError ) {
					if (isJSON(jqXHR.responseText)) {
						res=JSON.parse(jqXHR.responseText);
						MyModal(res.title, res.message);
						if (res.http_response_code>=400 && sessionStorage.getItem('token')) {
							setTimeout(function() {
								sessionStorage.clear();
								window.location.href='index.html';
							}, 3000);	
						}
					} 
					else MyModal("Error", jqXHR.responseText);
				});
			});

			// Set up an event listener for the contact form.
			$('#retrieveRules').submit(function(e) {
				// Stop the browser from submitting the form.
				e.preventDefault();

				//Prepare the data to send
				var datasetType = document.getElementById("dataset");
				if(!datasetType.value){
					MyModal("Information", "Please choose a dataset!!!");
					return;
				}

                // Serialize the form data first in array form so to add more elements.
				var formData = $('#retrieveRules').serializeArray(); // convert form to array

				if (sessionStorage.getItem('token')) {
					formData.push({name: "token", value: sessionStorage.getItem('token')});
				}
				else {
					MyModal("Error", "You are not signed in!!! Please sign in/up");
					return;
				}

				// Submit the form using AJAX.
				$.ajax({
					type: 'POST',
					url: $('#retrieveRules').attr('action'),
					data: $.param(formData), //serialize the array
					beforeSend: function( xhr ) {
						$('#submitBtn').html("<b>Retrieving rules...</b>");	
  					}
				})
				.done(function(response) {
					if (isJSON(response)) {
						res=JSON.parse(response);
						if (res.http_response_code==200) {
							//MyModal("asd",res);

							$('#showResultsTbl').DataTable( {
								"data": dataset1,
								"columns": [
									{ "data": "name" },
									{ "data": "hr.position" },
									{ "data": "contact.0" },
									{ "data": "contact.1" },
									{ "data": "hr.start_date" },
									{ "data": "hr.salary" }
								]
							} );

							// $('#showResultsTbl').DataTable( {
							// 	"processing": true,
							// 	"ajax": "Python/output/79d1727987f200802593e3599119c966/1/groceries.json",
							// 	columns: [
							// 		{ "data": "rules.Confidence" },
							// 		{ "data": "rules.Lift" },
							// 		{ "data": "rules.Conviction" },
							// 		{ "data": "rules.Leverage" }
							// 	]
							// } );


						} else {
							MyModal(res.http_response_code, res.message);
						}
					}
					else alert(response);
				})
				.fail(function(jqXHR) {
					if (isJSON(jqXHR.responseText)) {
						res=JSON.parse(jqXHR.responseText);
						MyModal(res.title, res.message);
						if (res.http_response_code>=400 && sessionStorage.getItem('token')) {
							setTimeout(function() {
								sessionStorage.clear();
								window.location.href='index.html';
							}, 3000);	
						}
					} 
					else MyModal("Error", jqXHR.responseText);
				})
				.always(function() {
					$('#submitBtn').html("Retrieve association rules");
				});
			});


		});

		function GetDatasetFilelist() {
			var formData = new FormData();
			if (sessionStorage.getItem('token')) {
				formData.set("token",sessionStorage.getItem('token'));
			}
			else {
				MyModal("Error", "You are not signed in!!! Please sign in/up");
				return;
			}

			$.ajax({
				type: 'POST' ,
				url: 'phpfunctions/retrieveDatasetFilelist.php',
				contentType: false,
                cache: false,
                processData:false ,
			    data: formData
			}) 	
			.done(function(response) {
				if (isJSON(response)) {
					res=JSON.parse(response);
					try {
						str='<option value="" disabled selected >Choose a dataset or dblclick to upload a new</option>';
						res.forEach(function(data, index){
							str += '<option value="' + data.filepath + '">(' + data.datasetType + ') ' + data.filename + '</option>'   
						});
						$("#dataset").html(str);
					}
					catch(err) {
						MyModal("Error", err.message);
					}
				}
				else {
					MyModal("Error", response);
				}
			}).fail(function( jqXHR, textStatus, thrownError ) {
				if (jqXHR.responseText) {
					if (isJSON(jqXHR.responseText)) {
						res=JSON.parse(jqXHR.responseText);
						MyModal(res.title + '(' + res.http_response_code + ')', res.message);
						if (res.http_response_code>=400 && sessionStorage.getItem('token')) {
							setTimeout(function() {
								sessionStorage.clear();
								window.location.href='index.html';
							}, 3000);	
						}
					}
					else alert(jqXHR.responseText);
				} else {
					MyModal("association rules",'Unknown error occured!');
				}
			});
		};

        // It handles the footer when the size of the window changes.
        function M_F() {
			if ($(window).width() <= 600) {
				$('.udfwidth').css("width", "98%");
			}
			else if ($(window).width() > 600 && $(window).width() <= 1500) {
				var pos1=Math.round(Math.abs($(window).width()-1500)*0.055+50);
				$('.udfwidth').css("width", pos1 + "%");
			}
			else {	
				$('.udfwidth').css("width", "50%");
			}
			style="width: 329px;"
            if ($(window).width() <= 800 || $(window).height() <= 600) {
                $('#c-footer').removeClass('fixed-bottom');
            }
            else {
                $('#c-footer').addClass('fixed-bottom')
            }
        };

        // handle the interface when guest or logged in
        function VT() {
            if (sessionStorage.getItem('token') && sessionStorage.getItem('token')!='0') {
                $('#SignUp').hide();
				$('#SignIn').hide();
                if (sessionStorage.getItem('username')) {
                    $('#person').html('<img src="images/person24.png" alt="p">' + sessionStorage.getItem('username'));
                    $('#person').show;
                } else {
                    $('#person').hide;
                }                    
                $('#sdropdown').show();
            } else {
                $('#SignUp').show();
                $('#SignIn').show();
                $('#sdropdown').hide();
            }
        };

        $( window ).resize(function() {
            M_F();
        });		
		
		function UploadDataset() {
			if ($('#uploadDatasetform').is(":visible")) {
				$('#uploadDatasetform').hide( "slow" );
			}
			else {
				$('#uploadDatasetform').show( "slow" );
			}
		};

		function deletecurrentDataset() {
			var x = document.getElementById("dataset");
			if (!x.value) {
				MyModal("Information","No dataset to delete.");
			}
		};

		//Load & delete filters ...start
		// function SelectFilter() {
				
		// 	//request data from php
		// 	var token = sessionStorage.getItem('token');
		// 	$.post('/phpfunctions/loadfiltersname.php', {
		// 		token: token
		// 	}, function(data) { //data from php
		// 		if (data != "0 results"){
		// 			data = JSON.parse(data);
		// 			$('#Selfilters').empty();
		// 			$('#Selfilters').append('<option value="" selected disabled >select filter</option>'); //Default option
		// 			data.forEach(function(FilterName){ //fill select options
		// 				$('#Selfilters').append("<option id='" + FilterName.FilterName + "' value='"+ FilterName.FilterName + "'>"+ FilterName.FilterName + "   /   " + FilterName.FilterDate +"</option>");
		// 			});
		// 		}
		// 		else {
		// 			$('#Selfilters').empty();
		// 			$('#Selfilters').append('<option value="" selected disabled >select filter</option>'); //Default option
		// 		}		
		// 	});
			
		// 	$( "#loadfilterdialog" ).show();
		// 	$( "#loadfilterdialog" ).dialog({
		// 		buttons: {
		// 			"Load filter": function() {
		// 				//get selection
		// 				var doc = document.getElementById('Selfilters');
		// 				var FilterName = doc.options[doc.selectedIndex].value;
		// 				//request data from php
		// 				var token = sessionStorage.getItem('token');
		// 				if (FilterName != ""){
		// 					$.post('/phpfunctions/loadfilter.php', {
		// 						token: token,
		// 						FilterName: FilterName
		// 					}, function(data) { //data from php
		// 						data = JSON.parse(data);
		// 						//fill data
		// 						data.forEach(function(Filter){ //fill form filters
		// 							document.getElementsByName('direction')[(Filter.FilterOneway-1)].checked=true;
		// 							if (Filter.FilterNonStop == 'on'){
		// 								document.getElementById('nonstop').checked = true;
		// 							}
		// 							else {
		// 								document.getElementById('nonstop').checked = false;
		// 							}
									
		// 							document.getElementById('origin_descr').value = Filter.FilterOrigin;
		// 							var matches = Filter.FilterOrigin.match(/\[(.*?)\]/);
		// 							if (matches) {
		// 								var submatch = matches[1];
		// 							}							
		// 							document.getElementById('origin').value = submatch;
									
		// 							document.getElementById('destination_descr').value = Filter.FilterDestination;
		// 							var matches = Filter.FilterDestination.match(/\[(.*?)\]/);
		// 							if (matches) {
		// 								var submatch = matches[1];
		// 							}								
		// 							document.getElementById('destination').value = submatch;

		// 							//parse tomorrow for comparison
		// 							var today = new Date();
		// 							var dd = today.getDate()+1;
		// 							var mm = today.getMonth()+1; //January is 0!
		// 							var yyyy = today.getFullYear();
		// 							if(dd<10) {
		// 								dd = '0'+dd
		// 							} 
		// 							if(mm<10) {
		// 								mm = '0'+mm
		// 							} 
		// 							tomorrow =  yyyy + '-' + mm + '-' + dd;

		// 							if (Filter.FilterDDate != '0000-00-00'){
		// 								if (Filter.FilterDDate<tomorrow) {
		// 									MyModal("Information","Departure date has passed. Tomorrow date will be used instead.");
		// 									midDate=tomorrow;
		// 								} else {
		// 									midDate = Filter.FilterDDate;
		// 								}
		// 								var mySQLDate = midDate.split("-");
		// 								var myJSDate =  mySQLDate[2]+ "/" +mySQLDate[1]+ "/" +mySQLDate[0];
		// 								document.getElementById('departure_date').value = myJSDate;
		// 								document.getElementById('ddate').value = midDate;
		// 							}
		// 							else {
		// 								document.getElementById('departure_date').value = "";
		// 							}
									
		// 							if (Filter.FilterRDate != '0000-00-00' && Filter.FilterOneway == '2'){
		// 								if (Filter.FilterRDate<tomorrow) {
		// 									MyModal("Information","Arrival date has passed. Tomorrow date will be used instead.");
		// 									midDate=tomorrow;
		// 								} else {
		// 									midDate = Filter.FilterRDate;
		// 								}
		// 								var mySQLDate = midDate.split("-");
		// 								var myJSDate =  mySQLDate[2]+ "/" +mySQLDate[1]+ "/" +mySQLDate[0];
		// 								document.getElementById("return_date").type = "text";
		// 								document.getElementById('return_date').value = myJSDate;
		// 								document.getElementById('rdate').value = midDate;
		// 							}
		// 							else {
		// 								document.getElementById("return_date").type = "hidden";
		// 								document.getElementById('return_date').value = "";
		// 							}
									
		// 						});						
		// 					});
		// 					$( this ).dialog( "close" );
		// 				}
		// 				else {
		// 					MyModal("Association rules mining","Nothing to load");
		// 				}
		// 			},
		// 			"Delete filter": function() {
		// 				//get selection
		// 				var doc = document.getElementById("Selfilters");
		// 				var FilterName = doc.options[doc.selectedIndex].value;
		// 				if (FilterName != ""){
		// 					//request data from php
		// 					var token = sessionStorage.getItem('token');
		// 					$.post('/phpfunctions/deletefilter.php', {
		// 						token: token,
		// 						FilterName: FilterName
		// 					}, function(data) { //data from php
		// 						MyModal("Association rules mining",data);
		// 					});
		// 					$( this ).dialog( "close" );
		// 				}
		// 				else { //trying to delete default selection option
		// 					MyModal("Association rules mining","Nothing to delete");
		// 				}
		// 			}
		// 		},
		// 		clickOutside: true, // clicking outside the dialog will close it
		// 		clickOutsideTrigger: "#Selfilters"  // Element (id or class) that triggers the dialog opening 			
		// 	});
		// }
		//Load & delete filters ...end
	
// 		function CheckFilters() {
// 			if ($('#direction').val()!=1 && $('#direction').val()!=2) {
// 				MyModal("Wrong filters!", "Declare One way or round trip please!");
// 				return;
// 			}
// 			if (!$('#origin_descr').val()) {
// 				MyModal("Wrong filters!", "Please choose departure airport please!");
// 				return;
// 			}
// 			if (!$('#departure_date').val()) {
// 				MyModal("Wrong filters!", "Please choose departure date please!");
// 				return;
// 			}
// 			if (!$('#destination_descr').val()) {
// 				MyModal("Wrong filters!", "Please choose destination airport please!");
// 				return;
// 			}
// 			if ($('#direction').val()==2) {
// 				if (!$('#return_date').val()) {
// 					MyModal("Wrong filters!", "Please choose return date please!");
// 					return;
// 				}
// 			}
// 			$('#MyPrompt').modal('show')
// 		};

// 		//Save filter ...start
// 		function SaveFilter(SaveFilterName) {
// 			var msg;
// 			var format = /[!@#$%^&*()+\-=\[\]{};':"\\|,.<>\/?]/;
// 			var illegalC;
// 			//var SaveFilterName = prompt("Give a name to save this record");
// 			if (SaveFilterName != null) {
// 				SaveFilterName = SaveFilterName.trim();
// 				if(format.test(SaveFilterName)){
// 					illegalC = "1";
// 				} else {
// 					illegalC = "0";
// 				}
// 				if (SaveFilterName == null || SaveFilterName == "" ){
// 				msg = "Please fill a name";
// 				MyModal("Association rules mining",msg);
// 				}
// 				else if (illegalC == "1"){
// 					msg = "Please use only letters and numbers without special characters";
// 					MyModal("Association rules mining",msg);
// 					}
// 				else {
// 					var token = sessionStorage.getItem('token');
// //					var playload = JSON.parse(atob(token.split('.')[1]));
// //					var email = playload;

// 					var direction = $('input[name="direction"]:checked').val();
// 					var nonstop = $('input[name="nonstop"]:checked').val();
// 					if (nonstop != "on") {
// 						nonstop = "off";
// 						}
				
// 					var origin_descr = $('input[name="origin_descr"]').val();
// 					var destination_descr = $('input[name="destination_descr"]').val();
// 					var departure_date = $('input[name="departure_date"]').val();
// 					var return_date = $('input[name="return_date"]').val();
					
// 					$.post('/phpfunctions/savefilter.php', {
// 						token: token,
// 						SaveFilterName: SaveFilterName,
// 						direction: direction,
// 						nonstop: nonstop,
// 						origin_descr: origin_descr,
// 						destination_descr: destination_descr,
// 						departure_date: departure_date,
// 						return_date: return_date
// 					}, function(data) {
// 						MyModal("Association rules mining",data);
// 					});
// 				}
// 			}

// 		}

	</script>
	<!-- Save filter ...end -->

	
</head>

<body>

	<nav class="navbar navbar-expand-sm navbar-dark bg-dark">
		<a id="navbar-brand" class="navbar-brand d-none d-sm-block" data-toggle="modal" onclick="credits()" data-target="#Credits" href="#">
			<img class="d-inline-block mr-1" src="./images/basketwhite.svg" width="24" height="24" alt="">Association rules mining
        </a>		
		<ul class="navbar-nav mr-auto">
			<li class="nav-item">
				<a class="nav-link" href="index.html">Home</a>
			</li>
			<li class="nav-item">
				<a class="nav-link active">Rules search</a>
			</li>
		</ul>
		<ul class="navbar-nav ml-auto">
			<li id="Rate" class="nav-item">
				<a class="nav-link" href="https://docs.google.com/forms/d/e/1FAIpQLScLYL2nig3jOst4QNx-ojEawqks9j3yrVP0AHSkBTIXJAEr0w/viewform" target="_blank">Rate us!</a>
			</li>			
			<li id="SignUp" class="nav-item">
				<a class="nav-link" href="SignUp.html">Sign Up</a>
			</li>
			<li id="SignIn" class="nav-item active">
				<a class="nav-link" href="Login.html">Sign In</a>
			</li>
			<li id=sdropdown class="nav-item dropdown">
				<a class="nav-item nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
					<img src="images/settings24.png" alt="">
				</a>
				<div class="dropdown-menu dropdown-menu-right dropdown-menu-dark" aria-labelledby="navbarDropdown">
                    <p id="person" class="text-primary text-center"></p>
					<div class="dropdown-divider"></div>
					<a id="uploadDatasetDD" class="dropdown-item" onclick="UploadDataset()" href="#"><img src="images/upload24Black.png" alt=""> Upload dataset</a>
					<a id="savefilters" class="dropdown-item" onclick="CheckFilters()"    href="#"><img src="images/save24.png"     alt=""> Save search filters</a>
					<a id="loadfilters" class="dropdown-item" onclick="SelectFilter()"    href="#"><img src="images/load24.png"     alt=""> Load search filters</a>
					<div class="dropdown-divider"></div>
					<a id="settings"    class="dropdown-item" href="profile.html"><img src="images/settings24.png" alt="">Profile</a>
					<a id="SignOut"     class="dropdown-item" href="#"><img src="images/signout24.png" alt=""> Sign out</a>
				</div>
			</li>			
		</ul>
	</nav>

	<!-- Select filter button - start -->
	<!-- <div id="loadfilterdialog" title="Filter selection" style="display: none;">
		<select class="form-control" id="Selfilters" name="Selfilters" >
		</select>
	</div> -->
	<!-- Select filter button - end -->	
	
	<br>

	<form id="uploadDatasetform" action="phpfunctions/uploadDataset.php" method="post" enctype="multipart/form-data" style="display: none">
		<div class="udfwidth mx-auto border rounded p-2">
			<div class="form-row">
				<div class="col-11">
					<div class="form-row">
						<div class="col-5">
							<label class="float-right">Select dataset to upload:</label>
						</div>
						<div class="col-7">
							<input type="file" class="form-control-file" name="fileToUpload" id="fileToUpload" accept=".csv, .txt" >
						</div>						
					</div>
					<div class="form-row">
						<div class="col-1">
							<button type="button" class="btn btn-sm" id="hideUpload" onclick="toggleDisplay('#uploadDatasetform')" data-trigger="hover" data-toggle="tooltip" title="Hides upload new dataset section"><img src="./images/close24grey.png" width="24" height="24" alt="">	</button>
						</div>
						<div class="col-1">
							<!-- <button type="button" class="btn btn-sm" data-toggle="collapse" data-target="#collapseInfo" aria-expanded="false" aria-controls="collapseInfo" id="helpForDatasetType" data-trigger="hover" data-toggle="tooltip" title="Information for the dataset type"><img src="./images/help24grey.png" width="24" height="24" alt="">	</button> -->
							<button type="button" class="btn btn-sm" onclick="toggleDisplay('#infoForDS')" id="helpForDatasetType" data-trigger="hover" data-toggle="tooltip" title="Information for the dataset type"><img src="./images/help24grey.png" width="24" height="24" alt="">	</button>
						</div>
						<div class="col-3">
							<label class="col-form-label float-right">dataset type:</label>
						</div>
						<div class="col-7">
							<select id="datasetType" class="browser-default custom-select" data-html="true" data-trigger="hover" data-toggle="tooltip" 
							    title="<p>1) Market Basket list<br>2) Order/Invoice detail<br>3) Sparce item Dataset<br>4) Columns with multiple nomimal values</p>"
						    >
								<option value="" disabled selected>Choose a dataset type</option>
								<option value="1">Market basket list</option>
								<option value="2">Order/Invoice detail</option>
								<option value="3">Sparce item dataset</option>
								<option value="4">Multiple nomimal values</option>
							</select>
						</div>
					</div>		
				</div>
				<div class="col-1 border border-primary rounded p-1	">
					<button class="btn btn-primary btn-inline" type="submit" name="submit" style="height:100%; width:100%" id="uploadButton" data-trigger="hover" data-toggle="tooltip" title="Upload the Dataset!"><img src="./images/upload32White.png" width="32" height="32" alt=""></button>
				</div>
			</div>
		</div>
	</form>		

	<!-- <div class="collapse" id="collapseInfo"> -->
		<div id="infoForDS" class="udfwidth mx-auto border rounded p-2" style="display:none">
				<p><b>1) Market Basket list.</b> No header is expected, The number of columns is undefined (Default). 
				If header row exists, then participant columns must be declared in args starting from arg[1:], 
				In arg[0] the string representing the absent item must be declared. If absent item is nothing or not exists then assign '' or 'nan'.
				</br> 
				<b>2) Order/Invoice detail.</b> Header line is mandatory in that type. Number of columns is fixed in the dataset. 
				arg[0] represents the primary key column and arg[1] represent the items column and are both required in *args.
				</br> 
				<b>3) Sparce item Dataset.</b> Header line is mandatory in that type. Number of columns is fixed in the dataset. 
				Item columns are mandatory to be declared in args[1:].
				In arg[0] the string of absent item must be declared!!! If absent item is nothing then assign '' or 'nan'. 
			    </br>
			    <b>4) Columns with multiple categorized values.</b> Header line is optional. 
				Number of columns is fixed, optionally, items columns are expected in args in case that header line exists.
		</div>
	<!-- </div> -->

	<form id="retrieveRules" action="phpfunctions/retrieveRules.php" method="post" >
		<div class="udfwidth mx-auto border rounded p-2">
			<div class="form-row">
				<div class="col-9">	
					<label for="dataset">Select dataset or <a href="#" onclick="toggleDisplay('#uploadDatasetform');return false;" data-toggle="tooltip" title="Upload a new dataset on our server. Uploaded dataset limit is 10">upload</a> one:</label>			
				</div>
				<div class="col-2">	
					<label for="separator">Separator</label>			
				</div>
				<div class="col-1">	
					<button type="button" id="deleteDataset" class="btn mt-n2 float-right" data-trigger="hover" data-toggle="tooltip" title="Delete the current dataset"  onclick="deletecurrentDataset()">
						<img src="images/delete32grey.png" width="24" height="24" alt="">
					</button>
				</div>
			</div>
			<div class="form-row">
				<div class="col-9">	
					<select id="dataset" name="dataset" class="form-control browser-default custom-select" data-trigger="hover" data-toggle="tooltip" title="Pick the dataset for which association rules would be generated">
						<option value="" disabled selected>Choose a dataset from the list</option>
					</select>
				</div>	
				<div class="col-2">	
					<input type="text" id="separator" name="separator" class="form-control" data-trigger="hover" data-toggle="tooltip" title="the separator of the items in the CSV file. The most common characters are (,) and (;)" placeholder=",">		
				</div>
			</div>	
		</div>
		<div class="udfwidth mx-auto border rounded p-2">
			<div class="form-row">
				<div class="col-6">		
					<label for="min_support">Minimum support</label>
				</div>
				<div class="col-6">
					<label for="min_confidence">Minimum confidence</label>
				</div>
			</div>
			<div class="form-row">
				<div class="col-6">		
					<input type="text" id="min_support" name="min_support" class="form-control" data-trigger="hover" data-toggle="tooltip" title="The minimum support that each association rule should have" placeholder="0.01">
				</div>
				<div class="col-6">	
					<input type="text" id="min_confidence" name="min_confidence" class="form-control" data-trigger="hover" data-toggle="tooltip" title="The minimum confidence that each association rule should have" placeholder="0.2">
				</div>
			</div>
			<div class="form-row">
				<div class="col-6">		
					<label for="min_lift">Minimum lift</label>
				</div>
				<div class="col-6">
					<label for="max_length">Maximum rules items</label>
				</div>
			</div>
			<div class="form-row">
				<div class="col-6">		
					<input type="text" id="min_lift" name="min_lift" class="form-control" data-trigger="hover" data-toggle="tooltip" title="The minimum lift that each association rule should have" placeholder="1.5">
				</div>
				<div class="col-6">	
					<input type="text" id="max_length" name="max_length" class="form-control" data-trigger="hover" data-toggle="tooltip" title="The maximum items each association rule consist of" placeholder="2">
				</div>
			</div>	
			<div class="form-col">	
				<label for="extra parameters">Extra parameters / item names</label>
			</div>
			<div class="form-col">	
				<input type="text" id="extra_parameters" name="extra_parameters" class="form-control" data-trigger="hover" data-toggle="tooltip" title="The maximum items each association rule consist of" placeholder="special data (e.g item names)">
			</div>
			<div class="p-2 mx-auto" style="width: 300px;">
				<button id="submitBtn" type="submit" class="btn btn-primary ">Retrieve association rules</button>
			</div>
		</div>	
	</form>

	<br>
	<br>

	<div id="showResults" class="table-responsive">
		<table id="showResultsTbl" class="display" style="width:100%">
			<!-- <thead>
				<tr>
					<th>Name</th>
					<th>Position</th>
					<th>Office</th>
					<th>Extn.</th>
					<th>Start date</th>
					<th>Salary</th>
				</tr>
			</thead>
			<tfoot>
				<tr>
					<th>Name</th>
					<th>Position</th>
					<th>Office</th>
					<th>Extn.</th>
					<th>Start date</th>
					<th>Salary</th>
				</tr>
			</tfoot> -->
		</table>
	</div>

	<div class="modal fade" id="MyPrompt" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title text-primary" id="TitleText">Save search filters</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                       <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body container">
				   <p Id="InputLabel" class>Type a name for the search filters</p>
				   <input type="text" id="InputText" class="form-control" placeholder="Type a name">
				</div>
				
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" Id="PromptSave"  data-dismiss="modal">Save</button>
                    <button type="button" class="btn btn-secondary" Id="PromptCancel" data-dismiss="modal">Cancel</button>
                </div>
            </div>
        </div>
	</div>
	
	<footer>
        <nav id="c-footer" class="navbar fixed-bottom navbar-expand-lg navbar-dark bg-dark">
            <span class="text-muted">Association rules mining based on Apriori algorithm &middot; MSc in Web Intelligence &copy; 2019-2020</span>
        </nav>
	</footer> 

</body>
</html>
